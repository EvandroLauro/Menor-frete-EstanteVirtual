<html>
    <head>
        
    </head>
    <link rel="stylesheet" type="text/css" href="style.css">
    <!--=<script type="text/javascript" src="index.js"></script>-->
    <body>
        <div id="corpo-externo">
            <div id="corpo-interno-um">
                <input id="input-pagina-um" type="text" value="Adicione o ISBN"/>
                <button id="btnAdicionar-pagina-um" type="button" onclick='adicionarISBN()'>Adicionar</button>
                <div id="list-isbn">

                </div>
            </div>
        </div>
    </body>
</html>

<script>

    function adicionarISBN(){
        let input = document.getElementById("input-pagina-um");
        if (isRepetido(input.value) == input.value && !(input.value == "")) {
            alert(`'${input.value}' FOI INSERIDO, ADICIONE OUTRO ISBN!`);
            input.value = 'Adicione o ISBN';
        } else if (!(input.value == "" || input.value == 'Adicione o ISBN')) {
            let isbn = document.createElement("div");    
            isbn.setAttribute("id", input.value);
            isbn.setAttribute("class", "box-isbn");
            document.getElementById("list-isbn").prepend(isbn);
            document.getElementById(input.value).innerText = input.value;
            
            let btnDelete = document.createElement("button")
            let idBtnDelete = "btn-delete-".concat(input.value)
            btnDelete.setAttribute("id", idBtnDelete);
            btnDelete.setAttribute("class", "btn-delete");
            btnDelete.setAttribute("onclick", `deletarISBN('${idBtnDelete}')`)
            document.getElementById(input.value).prepend(btnDelete);
            document.getElementById(idBtnDelete).innerText = "x";
            
            input.value = 'Adicione o ISBN';
        }

        function isRepetido(valor) {
            let filhos = document.getElementById("list-isbn").children;
            return Object.entries(filhos).map((elem, index) => filhos.item(index).innerText.replace(/x+\n/,'')).filter((elem) => elem == valor);
        }
        
    }

    function deletarISBN(id) {
        console.log(id)
    }

    function clickDescliqueInput() {
        let btnAdicionar = document.getElementById("btnAdicionar-pagina-um");
        let input = document.getElementById("input-pagina-um"); 
        input.addEventListener("click", function(event) {
            input.value = "";
        });
        
        // NÃ£o entendo muito bem como esse contains(event.target) funciona
        document.addEventListener('click', function(event) {              
            let isClickInsideElementInput = input.contains(event.target); 
            let isClickInsideElementBtnAdicionar = btnAdicionar.contains(event.target)
            if (!isClickInsideElementInput && !isClickInsideElementBtnAdicionar && input.value == "Adicione o ISBN") {
                input.value = "Adicione o ISBN";
            } else if (!isClickInsideElementInput && !isClickInsideElementBtnAdicionar && input.value == "") {
                input.value = "Adicione o ISBN";
            } else if (isClickInsideElementBtnAdicionar && input.value == "") {
                input.value = "Adicione o ISBN";
            }
        });
    }

   
    window.addEventListener("load", clickDescliqueInput);

   

</script>